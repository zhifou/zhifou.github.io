/*! For license information please see 801.e8f87440.js.LICENSE.txt */
(self.webpackChunk_zhifou_rspress_blog=self.webpackChunk_zhifou_rspress_blog||[]).push([["801"],{59951:function(n,e,r){"use strict";r.r(e);var i=r("35250"),s=r("51325");function o(n){let e=Object.assign({h2:"h2",a:"a",p:"p",strong:"strong",ul:"ul",li:"li",pre:"pre",code:"code",del:"del"},(0,s.useMDXComponents)(),n.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(e.h2,{id:"nginxconf\u57FA\u672C\u914D\u7F6E\u6709\u54EA\u4E9B",children:[(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#nginxconf\u57FA\u672C\u914D\u7F6E\u6709\u54EA\u4E9B",children:"#"}),"nginx.conf\u57FA\u672C\u914D\u7F6E\u6709\u54EA\u4E9B\uFF1F"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"nginx\u914D\u7F6E\u6587\u4EF6\u4E3B\u8981\u5206\u6210\u56DB\u4E2A\u90E8\u5206\uFF1A"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"main\uFF0C\u5168\u5C40\u8BBE\u7F6E\uFF0C\u5F71\u54CD\u5176\u5B83\u90E8\u5206\u6240\u6709\u8BBE\u7F6E"}),"\n",(0,i.jsx)(e.li,{children:"server\uFF0C\u4E3B\u673A\u670D\u52A1\u76F8\u5173\u8BBE\u7F6E\uFF0C\u4E3B\u8981\u7528\u4E8E\u6307\u5B9A\u865A\u62DF\u4E3B\u673A\u57DF\u540D\u3001IP\u548C\u7AEF\u53E3"}),"\n",(0,i.jsx)(e.li,{children:"location\uFF0CURL\u5339\u914D\u7279\u5B9A\u4F4D\u7F6E\u540E\u7684\u8BBE\u7F6E\uFF0C\u53CD\u5411\u4EE3\u7406\u3001\u5185\u5BB9\u7BE1\u6539\u76F8\u5173\u8BBE\u7F6E"}),"\n",(0,i.jsx)(e.li,{children:"upstream\uFF0C\u4E0A\u6E38\u670D\u52A1\u5668\u8BBE\u7F6E\uFF0C\u8D1F\u8F7D\u5747\u8861\u76F8\u5173\u914D\u7F6E"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4ED6\u4EEC\u4E4B\u95F4\u7684\u5173\u7CFB\u5F0F\uFF1Aserver\u7EE7\u627Fmain\uFF0Clocation\u7EE7\u627Fserver\uFF1B"}),"\n",(0,i.jsx)(e.p,{children:"upstream\u65E2\u4E0D\u4F1A\u7EE7\u627F\u6307\u4EE4\u4E5F\u4E0D\u4F1A\u88AB\u7EE7\u627F\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u901A\u7528\u7684\u914D\u7F6E\u548C\u8BE6\u89E3\uFF1A"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",meta:"",children:"#\u5B9A\u4E49 Nginx \u8FD0\u884C\u7684\u7528\u6237\u548C\u7528\u6237\u7EC4,\u9ED8\u8BA4\u7531 nobody \u8D26\u53F7\u8FD0\u884C, windows \u4E0B\u9762\u53EF\u4EE5\u6CE8\u91CA\u6389\u3002 \nuser  nobody;\n\n#nginx\u8FDB\u7A0B\u6570\uFF0C\u5EFA\u8BAE\u8BBE\u7F6E\u4E3A\u7B49\u4E8ECPU\u603B\u6838\u5FC3\u6570\u3002\u53EF\u4EE5\u548Cworker_cpu_affinity\u914D\u5408\nworker_processes  1;\n\n#\u5168\u5C40\u9519\u8BEF\u65E5\u5FD7\u5B9A\u4E49\u7C7B\u578B\uFF0C[ debug | info | notice | warn | error | crit ]\n#error_log  logs/error.log;\n#error_log  logs/error.log  notice;\n#error_log  logs/error.log  info;\n\n#\u8FDB\u7A0B\u6587\u4EF6\uFF0Cwindow\u4E0B\u53EF\u4EE5\u6CE8\u91CA\u6389\n#pid    logs/nginx.pid;\n\n#\u4E00\u4E2Anginx\u8FDB\u7A0B\u6253\u5F00\u7684\u6700\u591A\u6587\u4EF6\u63CF\u8FF0\u7B26(\u53E5\u67C4)\u6570\u76EE\uFF0C\u7406\u8BBA\u503C\u5E94\u8BE5\u662F\u6700\u591A\u6253\u5F00\u6587\u4EF6\u6570\uFF08\u7CFB\u7EDF\u7684\u503Culimit -n\uFF09\u4E0Enginx\u8FDB\u7A0B\u6570\u76F8\u9664\uFF0C\n#\u4F46\u662Fnginx\u5206\u914D\u8BF7\u6C42\u5E76\u4E0D\u5747\u5300\uFF0C\u6240\u4EE5\u5EFA\u8BAE\u4E0Eulimit -n\u7684\u503C\u4FDD\u6301\u4E00\u81F4\u3002\nworker_rlimit_nofile 65535;\n\n#\u5DE5\u4F5C\u6A21\u5F0F\u4E0E\u8FDE\u63A5\u6570\u4E0A\u9650\nevents {\n   #\u53C2\u8003\u4E8B\u4EF6\u6A21\u578B\uFF0Cuse [ kqueue | rtsig | epoll | /dev/poll | select | poll ]; \n   #epoll\u6A21\u578B\u662FLinux 2.6\u4EE5\u4E0A\u7248\u672C\u5185\u6838\u4E2D\u7684\u9AD8\u6027\u80FD\u7F51\u7EDCI/O\u6A21\u578B\uFF0C\u5982\u679C\u8DD1\u5728FreeBSD\u4E0A\u9762\uFF0C\u5C31\u7528kqueue\u6A21\u578B\u3002\n   #use epoll;\n   #connections 20000;  # \u6BCF\u4E2A\u8FDB\u7A0B\u5141\u8BB8\u7684\u6700\u591A\u8FDE\u63A5\u6570\n   #\u5355\u4E2A\u8FDB\u7A0B\u6700\u5927\u8FDE\u63A5\u6570\uFF08\u6700\u5927\u8FDE\u63A5\u6570=\u8FDE\u63A5\u6570*\u8FDB\u7A0B\u6570\uFF09\u8BE5\u503C\u53D7\u7CFB\u7EDF\u8FDB\u7A0B\u6700\u5927\u6253\u5F00\u6587\u4EF6\u6570\u9650\u5236\uFF0C\u9700\u8981\u4F7F\u7528\u547D\u4EE4ulimit -n \u67E5\u770B\u5F53\u524D\u8BBE\u7F6E\n   worker_connections 65535;\n}\n\n#\u8BBE\u5B9Ahttp\u670D\u52A1\u5668\nhttp {\n    #\u6587\u4EF6\u6269\u5C55\u540D\u4E0E\u6587\u4EF6\u7C7B\u578B\u6620\u5C04\u8868\n    #include \u662F\u4E2A\u4E3B\u6A21\u5757\u6307\u4EE4\uFF0C\u53EF\u4EE5\u5C06\u914D\u7F6E\u6587\u4EF6\u62C6\u5206\u5E76\u5F15\u7528\uFF0C\u53EF\u4EE5\u51CF\u5C11\u4E3B\u914D\u7F6E\u6587\u4EF6\u7684\u590D\u6742\u5EA6\n    include       mime.types;\n\n    #\u9ED8\u8BA4\u6587\u4EF6\u7C7B\u578B\n    default_type  application/octet-stream;\n\n    #\u9ED8\u8BA4\u7F16\u7801\n    #charset utf-8; \n\n    #\u5B9A\u4E49\u865A\u62DF\u4E3B\u673A\u65E5\u5FD7\u7684\u683C\u5F0F\n    #log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n    #                  '$status $body_bytes_sent \"$http_referer\" '\n    #                  '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\n    #\u5B9A\u4E49\u865A\u62DF\u4E3B\u673A\u8BBF\u95EE\u65E5\u5FD7\n    #access_log  logs/access.log  main;\n\n    #\u5F00\u542F\u9AD8\u6548\u6587\u4EF6\u4F20\u8F93\u6A21\u5F0F\uFF0Csendfile\u6307\u4EE4\u6307\u5B9Anginx\u662F\u5426\u8C03\u7528sendfile\u51FD\u6570\u6765\u8F93\u51FA\u6587\u4EF6\uFF0C\u5BF9\u4E8E\u666E\u901A\u5E94\u7528\u8BBE\u4E3A on\uFF0C\u5982\u679C\u7528\u6765\u8FDB\u884C\u4E0B\u8F7D\u7B49\u5E94\u7528\u78C1\u76D8IO\u91CD\u8D1F\u8F7D\u5E94\u7528\uFF0C\u53EF\u8BBE\u7F6E\u4E3Aoff\uFF0C\u4EE5\u5E73\u8861\u78C1\u76D8\u4E0E\u7F51\u7EDCI/O\u5904\u7406\u901F\u5EA6\uFF0C\u964D\u4F4E\u7CFB\u7EDF\u7684\u8D1F\u8F7D\u3002\u6CE8\u610F\uFF1A\u5982\u679C\u56FE\u7247\u663E\u793A\u4E0D\u6B63\u5E38\u628A\u8FD9\u4E2A\u6539\u6210off\u3002\n    sendfile        on;\n\n    #\u5F00\u542F\u76EE\u5F55\u5217\u8868\u8BBF\u95EE\uFF0C\u5408\u9002\u4E0B\u8F7D\u670D\u52A1\u5668\uFF0C\u9ED8\u8BA4\u5173\u95ED\u3002\n    #autoindex on; \n\n    #\u9632\u6B62\u7F51\u7EDC\u963B\u585E\n    #tcp_nopush     on;\n\n    #\u957F\u8FDE\u63A5\u8D85\u65F6\u65F6\u95F4\uFF0C\u5355\u4F4D\u662F\u79D2\uFF0C\u9ED8\u8BA4\u4E3A0\n    keepalive_timeout  65;\n\n    #gzip\u538B\u7F29\u529F\u80FD\u8BBE\u7F6E\n    gzip on; #\u5F00\u542Fgzip\u538B\u7F29\u8F93\u51FA\n    gzip_min_length 1k; #\u6700\u5C0F\u538B\u7F29\u6587\u4EF6\u5927\u5C0F\n    gzip_buffers    4 16k; #\u538B\u7F29\u7F13\u51B2\u533A\n    gzip_http_version 1.0; #\u538B\u7F29\u7248\u672C\uFF08\u9ED8\u8BA41.1\uFF0C\u524D\u7AEF\u5982\u679C\u662Fsquid2.5\u8BF7\u4F7F\u75281.0\uFF09\n    gzip_comp_level 6; #\u538B\u7F29\u7B49\u7EA7\n    #\u538B\u7F29\u7C7B\u578B\uFF0C\u9ED8\u8BA4\u5C31\u5DF2\u7ECF\u5305\u542Btext/html\uFF0C\u6240\u4EE5\u4E0B\u9762\u5C31\u4E0D\u7528\u518D\u5199\u4E86\uFF0C\u5199\u4E0A\u53BB\u4E5F\u4E0D\u4F1A\u6709\u95EE\u9898\uFF0C\u4F46\u662F\u4F1A\u6709\u4E00\u4E2Awarn\u3002\n    gzip_types text/plain text/css text/javascript application/json application/javascript application/x-javascript application/xml;\n    gzip_vary on; //\u548Chttp\u5934\u6709\u5173\u7CFB\uFF0C\u52A0\u4E2Avary\u5934\uFF0C\u7ED9\u4EE3\u7406\u670D\u52A1\u5668\u7528\u7684\uFF0C\u6709\u7684\u6D4F\u89C8\u5668\u652F\u6301\u538B\u7F29\uFF0C\u6709\u7684\u4E0D\u652F\u6301\uFF0C\u6240\u4EE5\u907F\u514D\u6D6A\u8D39\u4E0D\u652F\u6301\u7684\u4E5F\u538B\u7F29\uFF0C\u6240\u4EE5\u6839\u636E\u5BA2\u6237\u7AEF\u7684HTTP\u5934\u6765\u5224\u65AD\uFF0C\u662F\u5426\u9700\u8981\u538B\u7F29\n    \n    #\u5F00\u542F\u9650\u5236IP\u8FDE\u63A5\u6570\u7684\u65F6\u5019\u9700\u8981\u4F7F\u7528\n    #limit_zone crawler $binary_remote_addr 10m; \n\n    #http_proxy\u670D\u52A1\u5168\u5C40\u8BBE\u7F6E\n    client_max_body_size   10m;\n    client_body_buffer_size   128k;\n    proxy_connect_timeout   75;\n    proxy_send_timeout   75;\n    proxy_read_timeout   75;\n    proxy_buffer_size   4k;\n    proxy_buffers   4 32k;\n    proxy_busy_buffers_size   64k;\n    proxy_temp_file_write_size  64k;\n    proxy_temp_path   /usr/local/nginx/proxy_temp 1 2;\n\n    #\u8BBE\u5B9A\u8D1F\u8F7D\u5747\u8861\u540E\u53F0\u670D\u52A1\u5668\u5217\u8868 \n    upstream backend.com {\n        #ip_hash; # \u6307\u5B9A\u652F\u6301\u7684\u8C03\u5EA6\u7B97\u6CD5\n        #upstream \u7684\u8D1F\u8F7D\u5747\u8861\uFF0Cweight \u662F\u6743\u91CD\uFF0C\u53EF\u4EE5\u6839\u636E\u673A\u5668\u914D\u7F6E\u5B9A\u4E49\u6743\u91CD\u3002weigth \u53C2\u6570\u8868\u793A\u6743\u503C\uFF0C\u6743\u503C\u8D8A\u9AD8\u88AB\u5206\u914D\u5230\u7684\u51E0\u7387\u8D8A\u5927\u3002\n        server   192.168.10.100:8080 max_fails=2 fail_timeout=30s;\n        server   192.168.10.101:8080 max_fails=2 fail_timeout=30s;\n    }\n\n    #\u865A\u62DF\u4E3B\u673A\u7684\u914D\u7F6E\n    server {\n        #\u76D1\u542C\u7AEF\u53E3\n        listen       80;\n    \n        #\u57DF\u540D\u53EF\u4EE5\u6709\u591A\u4E2A\uFF0C\u7528\u7A7A\u683C\u9694\u5F00\n        server_name  localhost fontend.com;\n\n        #Server Side Include\uFF0C\u901A\u5E38\u79F0\u4E3A\u670D\u52A1\u5668\u7AEF\u5D4C\u5165\n        #ssi on;\n\n        #\u9ED8\u8BA4\u7F16\u7801\n        #charset utf-8;\n\n        #\u5B9A\u4E49\u672C\u865A\u62DF\u4E3B\u673A\u7684\u8BBF\u95EE\u65E5\u5FD7\n        #access_log  logs/host.access.log  main;\n\n        #\u56E0\u4E3A\u6240\u6709\u7684\u5730\u5740\u90FD\u4EE5 / \u5F00\u5934\uFF0C\u6240\u4EE5\u8FD9\u6761\u89C4\u5219\u5C06\u5339\u914D\u5230\u6240\u6709\u8BF7\u6C42\n        location / {\n            root   html;\n            index  index.html index.htm;\n        }\n\n        #error_page  404              /404.html;\n\n        #redirect server error pages to the static page /50x.html\n        #error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n\n        #\u56FE\u7247\u7F13\u5B58\u65F6\u95F4\u8BBE\u7F6E\n        location ~ .*.(gif|jpg|jpeg|png|bmp|swf)$ {\n           expires 10d;\n        }\n\n        #JS\u548CCSS\u7F13\u5B58\u65F6\u95F4\u8BBE\u7F6E\n        location ~ .*.(js|css)?$ {\n           expires 1h;\n        }\n\n        #\u4EE3\u7406\u914D\u7F6E\n        #proxy the PHP scripts to Apache listening on 127.0.0.1:80\n        #location /proxy/ {\n        #    proxy_pass   http://127.0.0.1;\n        #}\n\n        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\n        #\n        #location ~ \\.php$ {\n        #    root           html;\n        #    fastcgi_pass   127.0.0.1:9000;\n        #    fastcgi_index  index.php;\n        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;\n        #    include        fastcgi_params;\n        #}\n\n        # deny access to .htaccess files, if Apache's document root\n        # concurs with nginx's one\n        #\n        #location ~ /\\.ht {\n        #    deny  all;\n        #}\n    }\n\n    # another virtual host using mix of IP-, name-, and port-based configuration\n    #\n    #server {\n    #    listen       8000;\n    #    listen       somename:8080;\n    #    server_name  somename  alias  another.alias;\n\n    #    location / {\n    #        root   html;\n    #        index  index.html index.htm;\n    #    }\n    #}\n\n    # HTTPS server\n    #\n    #server {\n    #    listen       443 ssl;\n    #    server_name  localhost;\n    #    ssl_certificate      cert.pem;\n    #    ssl_certificate_key  cert.key;\n    #    ssl_session_cache    shared:SSL:1m;\n    #    ssl_session_timeout  5m;\n    #    ssl_ciphers  HIGH:!aNULL:!MD5;\n    #    ssl_prefer_server_ciphers  on;\n    #    location / {\n    #        root   html;\n    #        index  index.html index.htm;\n    #    }\n    #}\n}\n\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"location\u5982\u4F55\u5339\u914D\uFF1F"})}),"\n",(0,i.jsxs)(e.p,{children:["\u4EE5 = \u5F00\u5934\u8868\u793A\u7CBE\u786E\u5339\u914D\n^~ \u5F00\u5934\u8868\u793Auri\u4EE5\u67D0\u4E2A\u5E38\u89C4\u5B57\u7B26\u4E32\u5F00\u5934\uFF0C\u4E0D\u662F\u6B63\u5219\u5339\u914D\n~ \u5F00\u5934\u8868\u793A\u533A\u5206\u5927\u5C0F\u5199\u7684\u6B63\u5219\u5339\u914D\n",(0,i.jsx)(e.del,{children:"* \u5F00\u5934\u8868\u793A\u4E0D\u533A\u5206\u5927\u5C0F\u5199\u7684\u6B63\u5219\u5339\u914D\n/ \u901A\u7528\u5339\u914D, \u5982\u679C\u6CA1\u6709\u5176\u5B83\u5339\u914D,\u4EFB\u4F55\u8BF7\u6C42\u90FD\u4F1A\u5339\u914D\u5230\n\u4F18\u5148\u7EA7\uFF1A\n(location =) > (location \u5B8C\u6574\u8DEF\u5F84) > (location ^"})," \u8DEF\u5F84) > (location ",(0,i.jsx)(e.del,{children:","}),"* \u6B63\u5219\u987A\u5E8F) > (location \u90E8\u5206\u8D77\u59CB\u8DEF\u5F84) > (/)"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",meta:"",children:"location  = / {\n  # \u7CBE\u786E\u5339\u914D / \uFF0C\u4E3B\u673A\u540D\u540E\u9762\u4E0D\u80FD\u5E26\u4EFB\u4F55\u5B57\u7B26\u4E32\n  [ configuration A ] \n}\n\nlocation  / {\n  # \u56E0\u4E3A\u6240\u6709\u7684\u5730\u5740\u90FD\u4EE5 / \u5F00\u5934\uFF0C\u6240\u4EE5\u8FD9\u6761\u89C4\u5219\u5C06\u5339\u914D\u5230\u6240\u6709\u8BF7\u6C42\n  # \u4F46\u662F\u6B63\u5219\u548C\u6700\u957F\u5B57\u7B26\u4E32\u4F1A\u4F18\u5148\u5339\u914D\n  [ configuration B ] \n}\n\nlocation /documents/ {\n  # \u5339\u914D\u4EFB\u4F55\u4EE5 /documents/ \u5F00\u5934\u7684\u5730\u5740\uFF0C\u5339\u914D\u7B26\u5408\u4EE5\u540E\uFF0C\u8FD8\u8981\u7EE7\u7EED\u5F80\u4E0B\u641C\u7D22\n  # \u53EA\u6709\u540E\u9762\u7684\u6B63\u5219\u8868\u8FBE\u5F0F\u6CA1\u6709\u5339\u914D\u5230\u65F6\uFF0C\u8FD9\u4E00\u6761\u624D\u4F1A\u91C7\u7528\u8FD9\u4E00\u6761\n  [ configuration C ] \n}\n\nlocation ~ /documents/Abc {\n  # \u5339\u914D\u4EFB\u4F55\u4EE5 /documents/ \u5F00\u5934\u7684\u5730\u5740\uFF0C\u5339\u914D\u7B26\u5408\u4EE5\u540E\uFF0C\u8FD8\u8981\u7EE7\u7EED\u5F80\u4E0B\u641C\u7D22\n  # \u53EA\u6709\u540E\u9762\u7684\u6B63\u5219\u8868\u8FBE\u5F0F\u6CA1\u6709\u5339\u914D\u5230\u65F6\uFF0C\u8FD9\u4E00\u6761\u624D\u4F1A\u91C7\u7528\u8FD9\u4E00\u6761\n  [ configuration CC ] \n}\n\nlocation ~* \\.(gif|jpg|jpeg)$ {\n  # \u5339\u914D\u6240\u6709\u4EE5 gif,jpg\u6216jpeg \u7ED3\u5C3E\u7684\u8BF7\u6C42\n  # \u7136\u800C\uFF0C\u6240\u6709\u8BF7\u6C42 /images/ \u4E0B\u7684\u56FE\u7247\u4F1A\u88AB config D \u5904\u7406\uFF0C\u56E0\u4E3A ^~ \u5230\u8FBE\u4E0D\u4E86\u8FD9\u4E00\u6761\u6B63\u5219\n  [ configuration E ] \n}\n\nlocation ^~ /images/ {\n  # \u5339\u914D\u4EFB\u4F55\u4EE5 /images/ \u5F00\u5934\u7684\u5730\u5740\uFF0C\u5339\u914D\u7B26\u5408\u4EE5\u540E\uFF0C\u505C\u6B62\u5F80\u4E0B\u641C\u7D22\u6B63\u5219\uFF0C\u91C7\u7528\u8FD9\u4E00\u6761\u3002\n  [ configuration D ] \n}\n\nlocation /images/ {\n  # \u5B57\u7B26\u5339\u914D\u5230 /images/\uFF0C\u7EE7\u7EED\u5F80\u4E0B\uFF0C\u4F1A\u53D1\u73B0 ^~ \u5B58\u5728\n  [ configuration F ] \n}\n\nlocation /images/abc {\n  # \u6700\u957F\u5B57\u7B26\u5339\u914D\u5230 /images/abc\uFF0C\u7EE7\u7EED\u5F80\u4E0B\uFF0C\u4F1A\u53D1\u73B0 ^~ \u5B58\u5728\n  # F\u4E0EG\u7684\u653E\u7F6E\u987A\u5E8F\u662F\u6CA1\u6709\u5173\u7CFB\u7684\n  [ configuration G ] \n}\n\nlocation ~ /images/abc/ {\n  # \u53EA\u6709\u53BB\u6389 config D \u624D\u6709\u6548\uFF1A\u5148\u6700\u957F\u5339\u914D config G \u5F00\u5934\u7684\u5730\u5740\uFF0C\u7EE7\u7EED\u5F80\u4E0B\u641C\u7D22\uFF0C\u5339\u914D\u5230\u8FD9\u4E00\u6761\u6B63\u5219\uFF0C\u91C7\u7528\n  [ configuration H ] \n}\n\nlocation ~* /js/.*/\\.js {\n  [ configuration I ] \n}\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5982\u4F55\u914D\u7F6E\u53CD\u5411\u4EE3\u7406\uFF1F"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",meta:"",children:"# \u5BF9 \u201C/\u201D \u542F\u7528\u53CD\u5411\u4EE3\u7406\nlocation / {\n  \n  # \u8BBE\u7F6E\u8981\u4EE3\u7406\u7684 uri\uFF0C\u6CE8\u610F\u6700\u540E\u7684 /\u3002\u53EF\u4EE5\u662F Unix \u57DF\u5957\u63A5\u5B57\u8DEF\u5F84\uFF0C\u4E5F\u53EF\u4EE5\u662F\u6B63\u5219\u8868\u8FBE\u5F0F\u3002\n  proxy_pass http://127.0.0.1:3000;\n  \n  # \u8BBE\u7F6E\u540E\u7AEF\u670D\u52A1\u5668\u201CLocation\u201D\u54CD\u5E94\u5934\u548C\u201CRefresh\u201D\u54CD\u5E94\u5934\u7684\u66FF\u6362\u6587\u672C\n  proxy_redirect off; \n\n  # \u83B7\u53D6\u7528\u6237\u7684\u771F\u5B9E IP \u5730\u5740\n  proxy_set_header X-Real-IP $remote_addr; \n\n  #\u540E\u7AEF\u7684Web\u670D\u52A1\u5668\u53EF\u4EE5\u901A\u8FC7 X-Forwarded-For \u83B7\u53D6\u7528\u6237\u771F\u5B9EIP\uFF0C\u591A\u4E2A nginx \u53CD\u4EE3\u7684\u60C5\u51B5\u4E0B\uFF0C\u4F8B\u5982 CDN\u3002\u53C2\u89C1\uFF1Ahttp://gong1208.iteye.com/blog/1559835 \u548C http://bbs.linuxtone.org/thread-9050-1-1.html\n  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\n  #\u4EE5\u4E0B\u662F\u4E00\u4E9B\u53CD\u5411\u4EE3\u7406\u7684\u914D\u7F6E\uFF0C\u53EF\u9009\u3002\n  # \u5141\u8BB8\u91CD\u65B0\u5B9A\u4E49\u6216\u8005\u6DFB\u52A0\u53D1\u5F80\u540E\u7AEF\u670D\u52A1\u5668\u7684\u8BF7\u6C42\u5934\u3002\n  proxy_set_header Host $host;\n\n  client_max_body_size 10m; #\u5141\u8BB8\u5BA2\u6237\u7AEF\u8BF7\u6C42\u7684\u6700\u5927\u5355\u6587\u4EF6\u5B57\u8282\u6570\n  client_body_buffer_size 128k; #\u7F13\u51B2\u533A\u4EE3\u7406\u7F13\u51B2\u7528\u6237\u7AEF\u8BF7\u6C42\u7684\u6700\u5927\u5B57\u8282\u6570\uFF0C\n  proxy_connect_timeout 90; #nginx\u8DDF\u540E\u7AEF\u670D\u52A1\u5668\u8FDE\u63A5\u8D85\u65F6\u65F6\u95F4(\u4EE3\u7406\u8FDE\u63A5\u8D85\u65F6)\n  proxy_send_timeout 90; #\u540E\u7AEF\u670D\u52A1\u5668\u6570\u636E\u56DE\u4F20\u65F6\u95F4(\u4EE3\u7406\u53D1\u9001\u8D85\u65F6)\n  proxy_read_timeout 90; #\u8FDE\u63A5\u6210\u529F\u540E\uFF0C\u540E\u7AEF\u670D\u52A1\u5668\u54CD\u5E94\u65F6\u95F4(\u4EE3\u7406\u63A5\u6536\u8D85\u65F6)\n  proxy_buffer_size 4k; #\u8BBE\u7F6E\u4EE3\u7406\u670D\u52A1\u5668\uFF08nginx\uFF09\u4FDD\u5B58\u7528\u6237\u5934\u4FE1\u606F\u7684\u7F13\u51B2\u533A\u5927\u5C0F\n  proxy_buffers 4 32k; #proxy_buffers\u7F13\u51B2\u533A\uFF0C\u7F51\u9875\u5E73\u5747\u572832k\u4EE5\u4E0B\u7684\u8BBE\u7F6E\n  proxy_busy_buffers_size 64k; #\u9AD8\u8D1F\u8377\u4E0B\u7F13\u51B2\u5927\u5C0F\uFF08proxy_buffers*2\uFF09\n  proxy_temp_file_write_size 64k; #\u8BBE\u5B9A\u7F13\u5B58\u6587\u4EF6\u5939\u5927\u5C0F\uFF0C\u5927\u4E8E\u8FD9\u4E2A\u503C\uFF0C\u5C06\u4ECEupstream\u670D\u52A1\u5668\u4F20\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6765\u4E2A\u5B9E\u4F8B\u770B\u770B\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",meta:"",children:"location ^~ /service/ {\n  proxy_pass http://192.168.60.245:8080/;\n  proxy_redirect      default;\n  proxy_set_header    Host $host\n  proxy_set_header    X-Real-IP $remote_addr;\n  proxy_set_header    X-Forwarded-For  $proxy_add_x_forwarded_for;\n}\n\nlocation /proxy/ {\n  proxy_pass http://backend.com/;\n  proxy_redirect      default;\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5982\u4F55\u914D\u7F6Erewrite\uFF1F"})}),"\n",(0,i.jsx)(e.p,{children:"rewrite\u529F\u80FD\u5C31\u662F\u96C6\u5408\u6B63\u5219\u8868\u8FBE\u5F0F\u548C\u6807\u5FD7\u4F4D\u5B9E\u73B0url\u91CD\u5199\u548C\u91CD\u5B9A\u5411\u3002"}),"\n",(0,i.jsx)(e.p,{children:"rewrite\u53EA\u80FD\u653E\u5728server{}\u3001location{}\u3001if(){}\u5757\u4E2D\uFF0C\u5E76\u4E14\u53EA\u80FD\u5BF9\u57DF\u540D\u540E\u8FB9\u7684\u51FA\u53BB\u4F20\u9012\u53C2\u6570\u5916\u7684\u5B57\u7B26\u4E32\u8D77\u4F5C\u7528\u3002\u5982URL\uFF1A"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.a,{href:"http://microloan-sms-platform.yxapp.xyz/proxy/sms/task/querydeleted?page=1&pagesize=10",target:"_blank",rel:"noopener noreferrer",children:"http://microloan-sms-platform.yxapp.xyz/proxy/sms/task/querydeleted?page=1&pagesize=10"})}),"\n",(0,i.jsx)(e.p,{children:"\u53EA\u5BF9/proxy/sms/task/querydeleted\u8FDB\u884C\u91CD\u5199\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u679C\u76F8\u5BF9\u57DF\u540D\u6216\u53C2\u6570\u5B57\u7B26\u4E32\u8D77\u4F5C\u7528\uFF0C\u53EF\u4EE5\u4F7F\u7528\u5168\u5C40\u53D8\u91CF\u5339\u914D\uFF0C\u4E5F\u53EF\u4EE5\u4F7F\u7528proxy_pass\u53CD\u5411\u4EE3\u7406\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u8868\u660E\u770Brewrite\u548Clocation\u529F\u80FD\u6709\u70B9\u50CF\uFF0C\u90FD\u80FD\u5B9E\u73B0\u8DF3\u8F6C\uFF0C\u4E3B\u8981\u533A\u522B\u5728\u4E8Erewrite\u662F\u5728\u540C\u4E00\u57DF\u540D\u5185\u66F4\u6539\u83B7\u53D6\u8D44\u6E90\u7684\u8DEF\u5F84\uFF0C\u800Clocation\u662F\u5BF9\u4E00\u7C7B\u8DEF\u5F84\u505A\u63A7\u5236\u8BBF\u95EE\u6216\u53CD\u5411\u4EE3\u7406\uFF0C\u53EF\u4EE5proxy_pass\u5230\u5176\u4ED6\u673A\u5668\u3002\u5F88\u591A\u60C5\u51B5\u4E0Brewrite\u4E5F\u4F1A\u5199\u5728location\u91CC\uFF0C\u5B83\u4EEC\u7684\u6267\u884C\u987A\u5E8F\u662F\uFF1A"}),"\n",(0,i.jsx)(e.p,{children:"\u6267\u884Cserver\u5757\u7684rewrite\u6307\u4EE4\u6267\u884Clocation\u5339\u914D\u6267\u884C\u9009\u5B9A\u7684location\u4E2D\u7684rewrite\u6307\u4EE4"}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u679C\u5176\u4E2D\u67D0\u6B65URI\u88AB\u91CD\u5199\uFF0C\u5219\u91CD\u65B0\u5FAA\u73AF\u6267\u884C1-3\uFF0C\u76F4\u5230\u627E\u5230\u771F\u5B9E\u5B58\u5728\u7684\u6587\u4EF6\uFF1B\u5FAA\u73AF\u8D85\u8FC710\u6B21\uFF0C\u5219\u8FD4\u56DE500 Internal Server Error\u9519\u8BEF\u3002"}),"\n",(0,i.jsx)(e.p,{children:"rewrite\u89C4\u5219\u540E\u8FB9\uFF0C\u901A\u5E38\u4F1A\u5E26\u6709flag\u6807\u5FD7\u4F4D\uFF1A"}),"\n",(0,i.jsx)(e.p,{children:"last : \u76F8\u5F53\u4E8EApache\u7684[L]\u6807\u8BB0\uFF0C\u8868\u793A\u5B8C\u6210rewritebreak : \u505C\u6B62\u6267\u884C\u5F53\u524D\u865A\u62DF\u4E3B\u673A\u7684\u540E\u7EEDrewrite\u6307\u4EE4\u96C6redirect : \u8FD4\u56DE302\u4E34\u65F6\u91CD\u5B9A\u5411\uFF0C\u5730\u5740\u680F\u4F1A\u663E\u793A\u8DF3\u8F6C\u540E\u7684\u5730\u5740permanent : \u8FD4\u56DE301\u6C38\u4E45\u91CD\u5B9A\u5411\uFF0C\u5730\u5740\u680F\u4F1A\u663E\u793A\u8DF3\u8F6C\u540E\u7684\u5730\u5740"}),"\n",(0,i.jsx)(e.p,{children:"last \u548C break \u533A\u522B\uFF1A"}),"\n",(0,i.jsx)(e.p,{children:"last\u4E00\u822C\u5199\u5728server\u548Cif\u4E2D\uFF0C\u800Cbreak\u4E00\u822C\u4F7F\u7528\u5728location\u4E2Dlast\u4E0D\u7EC8\u6B62\u91CD\u5199\u540E\u7684url\u5339\u914D\uFF0C\u5373\u65B0\u7684url\u4F1A\u518D\u4ECEserver\u8D70\u4E00\u904D\u5339\u914D\u6D41\u7A0B\uFF0C\u800Cbreak\u7EC8\u6B62\u91CD\u5199\u540E\u7684\u5339\u914Dbreak\u548Clast\u90FD\u80FD\u7EC4\u7EC7\u7EE7\u7EED\u6267\u884C\u540E\u9762\u7684rewrite\u6307\u4EE4"}),"\n",(0,i.jsx)(e.p,{children:"rewrite\u5E38\u7528\u6B63\u5219\uFF1A"}),"\n",(0,i.jsx)(e.p,{children:". \uFF1A \u5339\u914D\u9664\u6362\u884C\u7B26\u4EE5\u5916\u7684\u4EFB\u610F\u5B57\u7B26? \uFF1A \u91CD\u590D0\u6B21\u62161\u6B21 \uFF1A \u91CD\u590D1\u6B21\u6216\u66F4\u591A\u6B21* \uFF1A \u91CD\u590D0\u6B21\u6216\u66F4\u591A\u6B21\\d \uFF1A\u5339\u914D\u6570\u5B57^ \uFF1A \u5339\u914D\u5B57\u7B26\u4E32\u7684\u5F00\u59CB$ \uFF1A \u5339\u914D\u5B57\u7B26\u4E32\u7684\u4ECB\u7ECD{n} \uFF1A \u91CD\u590Dn\u6B21{n,} \uFF1A \u91CD\u590Dn\u6B21\u6216\u66F4\u591A\u6B21 \uFF1A \u5339\u914D\u5355\u4E2A\u5B57\u7B26c[a-z] \uFF1A \u5339\u914Da-z\u5C0F\u5199\u5B57\u6BCD\u7684\u4EFB\u610F\u4E00\u4E2A"}),"\n",(0,i.jsx)(e.p,{children:"\u53EF\u4EE5\u4F7F\u7528()\u6765\u8FDB\u884C\u5206\u7EC4\uFF0C\u53EF\u4EE5\u901A\u8FC7$1\u7684\u5F62\u5F0F\u6765\u5F15\u7528\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",meta:"",children:"location /proxy/ {\n    proxy_pass http://microloan-notification-web.yxapp.in;\n    rewrite /proxy/(.*)$ /$1 break;\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5982\u4F55\u914D\u7F6E\u8D1F\u8F7D\u5747\u8861\uFF1F"})}),"\n",(0,i.jsx)(e.p,{children:"upstream\u662FNginx\u7684HTTP Upstream\u6A21\u5757\uFF0C\u8FD9\u4E2A\u6A21\u5757\u901A\u8FC7\u4E00\u4E2A\u7B80\u5355\u7684\u8C03\u5EA6\u7B97\u6CD5\u6765\u5B9E\u73B0\u5BA2\u6237\u7AEFIP\u5230\u540E\u7AEF\u670D\u52A1\u5668\u7684\u8D1F\u8F7D\u5747\u8861\u3002"}),"\n",(0,i.jsx)(e.p,{children:"Nginx\u7684\u8D1F\u8F7D\u5747\u8861\u6A21\u5757\u76EE\u524D\u652F\u63014\u79CD\u8C03\u5EA6\u7B97\u6CD5\uFF1A"}),"\n",(0,i.jsx)(e.p,{children:"\u8F6E\u8BE2\uFF08\u9ED8\u8BA4\uFF09\u3002\u6BCF\u4E2A\u8BF7\u6C42\u6309\u65F6\u95F4\u987A\u5E8F\u9010\u4E00\u5206\u914D\u5230\u4E0D\u540C\u7684\u540E\u7AEF\u670D\u52A1\u5668\uFF0C\u5982\u679C\u540E\u7AEF\u67D0\u53F0\u670D\u52A1\u5668\u5B95\u673A\uFF0C\u6545\u969C\u7CFB\u7EDF\u88AB\u81EA\u52A8\u5254\u9664\uFF0C\u4F7F\u7528\u6237\u8BBF\u95EE\u4E0D\u53D7\u5F71\u54CD\u3002Weight \u6307\u5B9A\u8F6E\u8BE2\u6743\u503C\uFF0CWeight\u503C\u8D8A\u5927\uFF0C\u5206\u914D\u5230\u7684\u8BBF\u95EE\u673A\u7387\u8D8A\u9AD8\uFF0C\u4E3B\u8981\u7528\u4E8E\u540E\u7AEF\u6BCF\u4E2A\u670D\u52A1\u5668\u6027\u80FD\u4E0D\u5747\u7684\u60C5\u51B5\u4E0B\u3002ip_hash\u3002\u6BCF\u4E2A\u8BF7\u6C42\u6309\u8BBF\u95EEIP\u7684hash\u7ED3\u679C\u5206\u914D\uFF0C\u8FD9\u6837\u6765\u81EA\u540C\u4E00\u4E2AIP\u7684\u8BBF\u5BA2\u56FA\u5B9A\u8BBF\u95EE\u4E00\u4E2A\u540E\u7AEF\u670D\u52A1\u5668\uFF0C\u6709\u6548\u89E3\u51B3\u4E86\u52A8\u6001\u7F51\u9875\u5B58\u5728\u7684session\u5171\u4EAB\u95EE\u9898\u3002fair\u3002\u8FD9\u662F\u6BD4\u4E0A\u9762\u4E24\u4E2A\u66F4\u52A0\u667A\u80FD\u7684\u8D1F\u8F7D\u5747\u8861\u7B97\u6CD5\u3002\u6B64\u79CD\u7B97\u6CD5\u53EF\u4EE5\u4F9D\u636E\u9875\u9762\u5927\u5C0F\u548C\u52A0\u8F7D\u65F6\u95F4\u957F\u77ED\u667A\u80FD\u5730\u8FDB\u884C\u8D1F\u8F7D\u5747\u8861\uFF0C\u4E5F\u5C31\u662F\u6839\u636E\u540E\u7AEF\u670D\u52A1\u5668\u7684\u54CD\u5E94\u65F6\u95F4\u6765\u5206\u914D\u8BF7\u6C42\uFF0C\u54CD\u5E94\u65F6\u95F4\u77ED\u7684\u4F18\u5148\u5206\u914D\u3002Nginx\u672C\u8EAB\u662F\u4E0D\u652F\u6301fair\u7684\uFF0C\u5982\u679C\u9700\u8981\u4F7F\u7528\u8FD9\u79CD\u8C03\u5EA6\u7B97\u6CD5\uFF0C\u5FC5\u987B\u4E0B\u8F7DNginx\u7684upstream_fair\u6A21\u5757\u3002url_hash\u3002\u6B64\u65B9\u6CD5\u6309\u8BBF\u95EEurl\u7684hash\u7ED3\u679C\u6765\u5206\u914D\u8BF7\u6C42\uFF0C\u4F7F\u6BCF\u4E2Aurl\u5B9A\u5411\u5230\u540C\u4E00\u4E2A\u540E\u7AEF\u670D\u52A1\u5668\uFF0C\u53EF\u4EE5\u8FDB\u4E00\u6B65\u63D0\u9AD8\u540E\u7AEF\u7F13\u5B58\u670D\u52A1\u5668\u7684\u6548\u7387\u3002Nginx\u672C\u8EAB\u662F\u4E0D\u652F\u6301url_hash\u7684\uFF0C\u5982\u679C\u9700\u8981\u4F7F\u7528\u8FD9\u79CD\u8C03\u5EA6\u7B97\u6CD5\uFF0C\u5FC5\u987B\u5B89\u88C5Nginx \u7684hash\u8F6F\u4EF6\u5305\u3002"}),"\n",(0,i.jsx)(e.p,{children:"upstream\u53EF\u4EE5\u8BBE\u5B9A\u6BCF\u4E2A\u540E\u7AEF\u670D\u52A1\u5668\u5728\u8D1F\u8F7D\u5747\u8861\u8C03\u5EA6\u4E2D\u7684\u72B6\u6001\uFF0C\u652F\u6301\u7684\u72B6\u6001\u53C2\u6570:"}),"\n",(0,i.jsx)(e.p,{children:"down\uFF0C\u8868\u793A\u5F53\u524D\u7684server\u6682\u65F6\u4E0D\u53C2\u4E0E\u8D1F\u8F7D\u5747\u8861backup\uFF0C\u9884\u7559\u7684\u5907\u4EFD\u673A\u5668\u3002\u5F53\u5176\u4ED6\u6240\u6709\u7684\u975Ebackup\u673A\u5668\u51FA\u73B0\u6545\u969C\u6216\u8005\u5FD9\u7684\u65F6\u5019\uFF0C\u624D\u4F1A\u8BF7\u6C42backup\u673A\u5668\uFF0C\u56E0\u6B64\u8FD9\u53F0\u673A\u5668\u7684\u538B\u529B\u6700\u8F7B\u3002max_fails\uFF0C\u5141\u8BB8\u8BF7\u6C42\u5931\u8D25\u7684\u6B21\u6570\uFF0C\u9ED8\u8BA4\u4E3A1\u3002\u5F53\u8D85\u8FC7\u6700\u5927\u6B21\u6570\u65F6\uFF0C\u8FD4\u56DEproxy_next_upstream \u6A21\u5757\u5B9A\u4E49\u7684\u9519\u8BEF\u3002fail_timeout\uFF0C\u5728\u7ECF\u5386\u4E86max_fails\u6B21\u5931\u8D25\u540E\uFF0C\u6682\u505C\u670D\u52A1\u7684\u65F6\u95F4\u3002max_fails\u53EF\u4EE5\u548Cfail_timeout\u4E00\u8D77\u4F7F\u7528\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u6CE8\uFF0C\u5F53\u8D1F\u8F7D\u8C03\u5EA6\u7B97\u6CD5\u4E3Aip_hash\u65F6\uFF0C\u540E\u7AEF\u670D\u52A1\u5668\u5728\u8D1F\u8F7D\u5747\u8861\u8C03\u5EA6\u4E2D\u7684\u72B6\u6001\u4E0D\u80FD\u662Fweight\u548Cbackup\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",meta:"",children:"upstream test.net{\n   ip_hash;\n   server 192.168.11.1:80;\n   server 192.168.11.11:80  down;\n   server 192.168.11.123:8009  max_fails=3  fail_timeout=20s;\n   server 192.168.11.1234:8080;\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5982\u4F55\u8BBE\u7F6E\u9875\u9762\u7F13\u5B58\uFF1F"})}),"\n",(0,i.jsx)(e.p,{children:"\u9875\u9762\u7F13\u5B58\u8BBE\u7F6E\u6307\u4EE4\uFF1A"}),"\n",(0,i.jsx)(e.p,{children:"proxy_cache_path : \u6307\u5B9A\u7F13\u5B58\u7684\u8DEF\u5F84\u548C\u4E00\u4E9B\u5176\u4ED6\u53C2\u6570\uFF0C\u7F13\u5B58\u7684\u6570\u636E\u5B58\u50A8\u5728\u6587\u4EF6\u4E2D\uFF0C\u5E76\u4E14\u4F7F\u7528\u4EE3\u7406url\u7684\u54C8\u5E0C\u503C\u4F5C\u4E3A\u5173\u952E\u5B57\u4E0E\u6587\u4EF6\u540D\u3002"}),"\n",(0,i.jsx)(e.p,{children:"proxy_cache_path /data/nginx/cache/webserver levels=1:2 keys_zone=webserver:20m max_size=1g;"}),"\n",(0,i.jsx)(e.p,{children:"levels\u53C2\u6570\u6307\u5B9A\u7F13\u5B58\u7684\u5B50\u76EE\u5F55\u6570\u3002keys_zone\u6307\u5B9A\u6D3B\u52A8\u7684key\u548C\u5143\u6570\u636E\u5B58\u50A8\u5728\u5171\u4EAB\u6C60\uFF08webserver\u4E3A\u5171\u4EAB\u6C60\u540D\u79F0\uFF0C20m\u4F4D\u5171\u4EAB\u6C60\u5927\u5C0F\uFF09\uFF0Cinactive\u53C2\u6570\u6307\u5B9A\u7684\u65F6\u95F4\u5185\u7F13\u5B58\u7684\u6570\u636E\u6CA1\u6709\u88AB\u8BF7\u6C42\u5219\u88AB\u5220\u9664\uFF0C\u9ED8\u8BA4inactive\u4E3A10\u5206\u949F\xb7max_size\u6307\u5B9A\u7F13\u5B58\u7A7A\u95F4\u7684\u5927\u5C0F\u3002"}),"\n",(0,i.jsx)(e.p,{children:"proxy_cache : \u8BBE\u7F6E\u4E00\u4E2A\u7F13\u5B58\u533A\u57DF\u7684\u540D\u79F0\uFF0C\u4E00\u4E2A\u76F8\u540C\u7684\u533A\u57DF\u53EF\u4EE5\u5728\u4E0D\u540C\u7684\u5730\u65B9\u4F7F\u7528\u3002proxy_cache_valid : \u4E3A\u4E0D\u540C\u7684\u5E94\u7B54\u8BBE\u7F6E\u4E0D\u540C\u7684\u7F13\u5B58\u65F6\u95F4\u3002\u5982\u4F55\u8BBE\u7F6E\u8BFB\u5199\u5206\u79BB\uFF1F"}),"\n",(0,i.jsx)(e.p,{children:"proxy_cache_valid : \u4E3A\u4E0D\u540C\u7684\u5E94\u7B54\u8BBE\u7F6E\u4E0D\u540C\u7684\u7F13\u5B58\u65F6\u95F4\u3002\u5982\u4F55\u8BBE\u7F6E\u8BFB\u5199\u5206\u79BB\uFF1F"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",meta:"",children:"proxy_cache_path /nginx/cache/webpages levels=1:2 keys_zone=webpages:30mmax_size=2g;\n\nserver {\n  listen       80;\n  server_name  localhost;\n  charset utf-8;\n  \n  #add headers\n  add_header X-Via $server_addr;\n  add_header X-Cache $upstream_cache_status;\n\n  location / {\n    proxy_pass http://webservers;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_cache webpages;\n    proxy_cache_valid 20010m;\n  }\n}\n"})})]})}function t(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,s.useMDXComponents)(),n.components);return e?(0,i.jsx)(e,Object.assign({},n,{children:(0,i.jsx)(o,n)})):o(n)}e.default=t,t.__RSPRESS_PAGE_META={},t.__RSPRESS_PAGE_META["..%2Fsource%2F_posts%2F2024-02-27-nginx-configuration.md"]={toc:[{id:"nginxconf\u57FA\u672C\u914D\u7F6E\u6709\u54EA\u4E9B",text:"nginx.conf\u57FA\u672C\u914D\u7F6E\u6709\u54EA\u4E9B\uFF1F",depth:2}],title:"",frontmatter:{layout:"post",title:"nginx\u914D\u7F6E",date:"2024-02-27T09:40:00.000Z",categories:["Web\u670D\u52A1\u5668"],tags:["nginx"]}}}}]);