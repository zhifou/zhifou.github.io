/*! For license information please see 837.3451ab94.js.LICENSE.txt */
(self.webpackChunk_zhifou_rspress_blog=self.webpackChunk_zhifou_rspress_blog||[]).push([["837"],{53129:function(e,n,r){"use strict";r.r(n);var s=r("35250"),l=r("51325");function t(e){let n=Object.assign({h2:"h2",a:"a",pre:"pre",code:"code",h3:"h3",ul:"ul",li:"li",p:"p"},(0,l.useMDXComponents)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h2,{id:"\u521B\u5EFA\u9879\u76EE",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u521B\u5EFA\u9879\u76EE",children:"#"}),"\u521B\u5EFA\u9879\u76EE"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",meta:"",children:"pnpm init -y\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"\u5B89\u88C5typescript",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u5B89\u88C5typescript",children:"#"}),"\u5B89\u88C5typescript"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",meta:"",children:"pnpm add typescript -D\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"\u5B89\u88C5rollup",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u5B89\u88C5rollup",children:"#"}),"\u5B89\u88C5rollup"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",meta:"",children:"pnpm add rollup -D\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"\u6839\u76EE\u5F55\u4E0B\u589E\u52A0tsconfigjson",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u6839\u76EE\u5F55\u4E0B\u589E\u52A0tsconfigjson",children:"#"}),"\u6839\u76EE\u5F55\u4E0B\u589E\u52A0tsconfig.json"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",meta:"",children:'{\n  "compilerOptions": {\n      "target": "esnext",\n      "module": "esnext",\n      "moduleResolution": "node",\n      "jsx": "react",\n      "allowJs": true,\n      "esModuleInterop": true,\n      "downlevelIteration": true,\n      "sourceMap": true,\n      "baseUrl": ".",\n      "paths": {\n          "@/*": [\n              "src/*"\n          ]\n      },\n      "allowSyntheticDefaultImports": true,\n      "skipLibCheck": true,\n      "declaration": false,\n      "strictNullChecks": true\n  },\n  "include": [\n      "src", "types.d.ts"\n  ],\n  "exclude": [\n      "node_modules",\n      "lib",\n      "es",\n      "dist",\n  ]\n}\n'})}),"\n",(0,s.jsxs)(n.h2,{id:"\u6839\u76EE\u5F55\u4E0B\u589E\u52A0\u4E00\u4E2A\u7C7B\u578B\u58F0\u660E\u6587\u4EF6typesdts",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u6839\u76EE\u5F55\u4E0B\u589E\u52A0\u4E00\u4E2A\u7C7B\u578B\u58F0\u660E\u6587\u4EF6typesdts",children:"#"}),"\u6839\u76EE\u5F55\u4E0B\u589E\u52A0\u4E00\u4E2A\u7C7B\u578B\u58F0\u660E\u6587\u4EF6types.d.ts"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",meta:"",children:"declare module window {}\n\ninterface Window {}\n\ninterface Document {}\n\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"\u4FEE\u6539packagejson\u914D\u7F6E",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u4FEE\u6539packagejson\u914D\u7F6E",children:"#"}),"\u4FEE\u6539package.json\u914D\u7F6E"]}),"\n",(0,s.jsxs)(n.h3,{id:"\u5BFC\u51FA\u591A\u79CD\u683C\u5F0Fcjsesmiife\u7684\u914D\u7F6E",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u5BFC\u51FA\u591A\u79CD\u683C\u5F0Fcjsesmiife\u7684\u914D\u7F6E",children:"#"}),"\u5BFC\u51FA\u591A\u79CD\u683C\u5F0F\uFF0Ccjs\u3001esm\u3001iife\u7684\u914D\u7F6E"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"cjs\u662Fcommonjs\u7684\u7F29\u5199\uFF0C\u652F\u6301\u4F7F\u7528require\u5BFC\u5165\u6A21\u5757"}),"\n",(0,s.jsx)(n.li,{children:"esm\u662Fes6\u6A21\u5757\u7684\u7F29\u5199\uFF0C\u652F\u6301\u4F7F\u7528import\u5BFC\u5165\u6A21\u5757"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",meta:"",children:'{\n    "type": "module",\n    "main": "./dist/bundle.cjs",\n    "module": "./dist/bundle.mjs",\n    "types": "./dist/bundle.d.ts",\n    "scripts": {\n        "dev": "rollup --config rollup.config.js --watch",\n        "build": "rollup --config rollup.config.js"\n    },\n    "devDependencies": {\n        "@types/node": "^20.12.7",\n        "rollup": "^4.17.0",\n        "tslib": "^2.6.2",\n        "typescript": "^5.4.5"\n    },\n    "peerDependencies": {\n        "react": ">=18.2.0"\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.h2,{id:"\u914D\u7F6Erollup",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u914D\u7F6Erollup",children:"#"}),"\u914D\u7F6Erollup"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u65B0\u5EFA ",(0,s.jsx)(n.code,{children:"rollup.config.js"})," \u6587\u4EF6"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{meta:"",children:'import { defineConfig } from "rollup";\n\nexport default defineConfig([\n    {\n        input: "./src/index.ts",\n        output: [\n            {\n                file: "dist/bundle.cjs",\n                format: "umd",\n                name: \'zhooks\', // umd \u7F16\u8BD1\u5FC5\u987B\u6709\u4E00\u4E2Aname\n                sourcemap: true, // \u589E\u52A0.map\u6587\u4EF6\uFF0C \u5982\u679C\u4E0D\u8BBE\u7F6E\u4F1A\u5728\u63A7\u5236\u53F0\u51FA\u73B0\u4E00\u4E2A\u8B66\u544A\uFF0C\u4E0D\u8FC7\u4E0D\u5F71\u54CD\u6253\u5305\u548C\u53D1\u5E03\uFF1A (!) [plugin typescript] @rollup/plugin-typescript: Rollup \'sourcemap\' option must be set to generate source maps.\n            },\n            {\n                file: "dist/bundle.mjs",\n                format: "esm",\n                sourcemap: true,\n            },\n        ],\n    },\n    {\n        input: "./src/index.ts",\n        output: [\n            {\n                file: "dist/bundle.d.ts",\n                format: "esm",\n            },\n        ],\n    },\n]);\n\n'})}),"\n",(0,s.jsxs)(n.h2,{id:"\u589E\u52A0rollup\u63D2\u4EF6",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u589E\u52A0rollup\u63D2\u4EF6",children:"#"}),"\u589E\u52A0rollup\u63D2\u4EF6"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",meta:"",children:"pnpm add @rollup/plugin-typescript rollup-plugin-dts\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/rollup/plugins",target:"_blank",rel:"noopener noreferrer",children:"@rollup/plugin-typescript"})," \u7528\u4E8E Rollup \u548C Typescript \u4E4B\u95F4\u7684\u65E0\u7F1D\u96C6\u6210\uFF0C\u7F16\u8BD1Typescript\u4E3AJavascript"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/Swatinem/rollup-plugin-dts",target:"_blank",rel:"noopener noreferrer",children:"rollup-plugin-dts"})," \u8FD9\u662F\u4E00\u4E2A\u53EF\u4EE5\u8BA9\u60A8\u751F\u6210.d.ts\u5B9A\u4E49\u6587\u4EF6\u7684\u63D2\u4EF6"]}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"rollupconfigjs\u914D\u7F6E\u63D2\u4EF6\u5B8C\u6574\u4EE3\u7801",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rollupconfigjs\u914D\u7F6E\u63D2\u4EF6\u5B8C\u6574\u4EE3\u7801",children:"#"}),"rollup.config.js\u914D\u7F6E\u63D2\u4EF6\u5B8C\u6574\u4EE3\u7801"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",meta:"",children:'import { defineConfig } from "rollup";\nimport typescript from "@rollup/plugin-typescript";\nimport dts from "rollup-plugin-dts";\n\nexport default defineConfig([\n    {\n        input: "./src/index.ts",\n        output: [\n            {\n                file: "dist/bundle.cjs",\n                format: "umd",\n                name: \'zhooks\',\n                sourcemap: true,\n                globals: {\n                    react: "react",\n                },\n            },\n            {\n                file: "dist/bundle.mjs",\n                format: "esm",\n                sourcemap: true,\n                globals: {\n                    react: "react",\n                },\n            },\n        ],\n\n        plugins: [typescript()],\n        watch: {\n            exclude: "node_modules/**", // \u4E0D\u76D1\u542C\n        },\n        external: ["react"], // \u6392\u9664\u9879\u76EE\u4E2D\u5F15\u7528\u7684\u7B2C\u4E09\u65B9\u5E93\n    },\n    {\n        input: "./src/index.ts",\n        output: [\n            {\n                file: "dist/bundle.d.ts",\n                format: "esm",\n            },\n        ],\n        plugins: [dts()],\n    },\n]);\n'})}),"\n",(0,s.jsxs)(n.h2,{id:"tsup\u5B9E\u73B0hooks\u7EC4\u4EF6\u53D1\u5E03",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#tsup\u5B9E\u73B0hooks\u7EC4\u4EF6\u53D1\u5E03",children:"#"}),"tsup\u5B9E\u73B0hooks\u7EC4\u4EF6\u53D1\u5E03"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"useWindowSize\u7EC4\u4EF6"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",meta:"",children:'import { useEffect, useState, useCallback } from "react";\n\nexport type Size = { width?: number; height?: number };\n\n/**\n * \u76D1\u542C\u7A97\u53E3\u5927\u5C0F\u53D8\u5316\u7684Hook\u7EC4\u4EF6\n * @returns {Size} \u7A97\u53E3\u5BBD\u9AD8\u5BF9\u8C61\n */\nconst useWindowSize = (): Size => {\n    const [state, setState] = useState<Size>(() => {\n        const { clientWidth, clientHeight } = (document as Document)\n            .documentElement;\n        return {\n            width: clientWidth,\n            height: clientHeight,\n        };\n    });\n\n    const onResize = useCallback(() => {\n        const { clientWidth, clientHeight } = (document as Document)\n            .documentElement;\n        setState({\n            width: clientWidth,\n            height: clientHeight,\n        });\n    }, []);\n\n    useEffect(() => {\n        window.addEventListener("resize", onResize, false);\n\n        return () => {\n            window.removeEventListener("resize", onResize, false);\n        };\n    }, []);\n\n    return state;\n};\n\nexport default useWindowSize;\n'})}),"\n",(0,s.jsxs)(n.h2,{id:"\u7F16\u8BD1",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u7F16\u8BD1",children:"#"}),"\u7F16\u8BD1"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",meta:"",children:"pnpm build\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u751F\u6210dist\u5982\u4E0B\uFF1A\ndist\n--- bundle.cjs\n--- bundle.cjs.map\n--- bundle.d.ts\n--- bundle.mjs\n--- bundle.mjs.map"}),"\n",(0,s.jsxs)(n.h2,{id:"\u5EFA\u8BAE\u52A0\u4E0Anpmrc\u6587\u4EF6\u52A0\u5FEB\u5B89\u88C5\u901F\u5EA6",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u5EFA\u8BAE\u52A0\u4E0Anpmrc\u6587\u4EF6\u52A0\u5FEB\u5B89\u88C5\u901F\u5EA6",children:"#"}),"\u5EFA\u8BAE\u52A0\u4E0A.npmrc\u6587\u4EF6\u52A0\u5FEB\u5B89\u88C5\u901F\u5EA6"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",meta:"",children:"registry=https://registry.npmmirror.com\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"\u5176\u5B83\u63D2\u4EF6\u5927\u5BB6\u53EF\u4EE5\u81EA\u884C\u7814\u7A76",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u5176\u5B83\u63D2\u4EF6\u5927\u5BB6\u53EF\u4EE5\u81EA\u884C\u7814\u7A76",children:"#"}),"\u5176\u5B83\u63D2\u4EF6\uFF0C\u5927\u5BB6\u53EF\u4EE5\u81EA\u884C\u7814\u7A76"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/rollup/plugins",target:"_blank",rel:"noopener noreferrer",children:"@rollup/plugin-node-resolve"})," \u8282\u70B9\u89E3\u6790\u7684\u63D2\u4EF6"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/rollup/plugins",target:"_blank",rel:"noopener noreferrer",children:"@rollup/plugin-commonjs"})," \u5C06commonjs\u8BED\u6CD5\u8F6C\u4E3Aes2015\u8BED\u6CD5\u7684\u63D2\u4EF6"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/rollup/plugins",target:"_blank",rel:"noopener noreferrer",children:"@rollup/plugin-babel"})," babel\u89E3\u6790\u7684\u63D2\u4EF6"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/rollup/plugins",target:"_blank",rel:"noopener noreferrer",children:"@rollup/plugin-replace"})," \u7F16\u8BD1\u65F6\u66FF\u6362\u76EE\u6807\u5B57\u7B26\u4E32\u7684\u63D2\u4EF6"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/ezolenko/rollup-plugin-typescript2",target:"_blank",rel:"noopener noreferrer",children:"rollup-plugin-typescript2"}),"  \u80FD\u6253\u5370Typescript\u7F16\u8BD1\u9519\u8BEF\u7684\u63D2\u4EF6"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/sheltondong/rollup-plugin-clear",target:"_blank",rel:"noopener noreferrer",children:"rollup-plugin-clear"})," \u6E05\u9664\u7F16\u8BD1\u7ED3\u679C\u7684\u63D2\u4EF6"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/TrySound/rollup-plugin-terser",target:"_blank",rel:"noopener noreferrer",children:"rollup-plugin-terser"})," \u538B\u7F29\u7684\u63D2\u4EF6"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/thgh/rollup-plugin-serve",target:"_blank",rel:"noopener noreferrer",children:"rollup-plugin-serve"})," \u542F\u52A8server\u8C03\u8BD5\u7684\u63D2\u4EF6"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/thgh/rollup-plugin-livereload",target:"_blank",rel:"noopener noreferrer",children:"rollup-plugin-livereload"})," server\u70ED\u52A0\u8F7D\u8C03\u8BD5\u7684\u63D2\u4EF6"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/bengsfort/rollup-plugin-generate-html-template",target:"_blank",rel:"noopener noreferrer",children:"rollup-plugin-generate-html-template"})," \u914D\u7F6E\u8C03\u8BD5html\u6587\u4EF6\u6A21\u7248\u7684\u63D2\u4EF6"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/egoist/rollup-plugin-postcss",target:"_blank",rel:"noopener noreferrer",children:"rollup-plugin-postcss"})," \u5904\u7406css\u517C\u5BB9\u6027\u7684\u63D2\u4EF6"]}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"\u672C\u7AD9\u6E90\u7801",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u672C\u7AD9\u6E90\u7801",children:"#"}),"\u672C\u7AD9\u6E90\u7801"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/zhifou/rollup-starter",target:"_blank",rel:"noopener noreferrer",children:"rollup-starter \u6E90\u4EE3\u7801"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/zhifou/tsup-starter",target:"_blank",rel:"noopener noreferrer",children:"tsup-starter \u6E90\u4EE3\u7801"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/zhifou/hooks",target:"_blank",rel:"noopener noreferrer",children:"hooks \u6E90\u4EE3\u7801"})}),"\n"]})]})}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,l.useMDXComponents)(),e.components);return n?(0,s.jsx)(n,Object.assign({},e,{children:(0,s.jsx)(t,e)})):t(e)}n.default=i,i.__RSPRESS_PAGE_META={},i.__RSPRESS_PAGE_META["..%2Fsource%2F_posts%2F2024-04-30-rollup-starter.md"]={toc:[{id:"\u521B\u5EFA\u9879\u76EE",text:"\u521B\u5EFA\u9879\u76EE",depth:2},{id:"\u5B89\u88C5typescript",text:"\u5B89\u88C5typescript",depth:2},{id:"\u5B89\u88C5rollup",text:"\u5B89\u88C5rollup",depth:2},{id:"\u6839\u76EE\u5F55\u4E0B\u589E\u52A0tsconfigjson",text:"\u6839\u76EE\u5F55\u4E0B\u589E\u52A0tsconfig.json",depth:2},{id:"\u6839\u76EE\u5F55\u4E0B\u589E\u52A0\u4E00\u4E2A\u7C7B\u578B\u58F0\u660E\u6587\u4EF6typesdts",text:"\u6839\u76EE\u5F55\u4E0B\u589E\u52A0\u4E00\u4E2A\u7C7B\u578B\u58F0\u660E\u6587\u4EF6types.d.ts",depth:2},{id:"\u4FEE\u6539packagejson\u914D\u7F6E",text:"\u4FEE\u6539package.json\u914D\u7F6E",depth:2},{id:"\u5BFC\u51FA\u591A\u79CD\u683C\u5F0Fcjsesmiife\u7684\u914D\u7F6E",text:"\u5BFC\u51FA\u591A\u79CD\u683C\u5F0F\uFF0Ccjs\u3001esm\u3001iife\u7684\u914D\u7F6E",depth:3},{id:"\u914D\u7F6Erollup",text:"\u914D\u7F6Erollup",depth:2},{id:"\u589E\u52A0rollup\u63D2\u4EF6",text:"\u589E\u52A0rollup\u63D2\u4EF6",depth:2},{id:"rollupconfigjs\u914D\u7F6E\u63D2\u4EF6\u5B8C\u6574\u4EE3\u7801",text:"rollup.config.js\u914D\u7F6E\u63D2\u4EF6\u5B8C\u6574\u4EE3\u7801",depth:2},{id:"tsup\u5B9E\u73B0hooks\u7EC4\u4EF6\u53D1\u5E03",text:"tsup\u5B9E\u73B0hooks\u7EC4\u4EF6\u53D1\u5E03",depth:2},{id:"\u7F16\u8BD1",text:"\u7F16\u8BD1",depth:2},{id:"\u5EFA\u8BAE\u52A0\u4E0Anpmrc\u6587\u4EF6\u52A0\u5FEB\u5B89\u88C5\u901F\u5EA6",text:"\u5EFA\u8BAE\u52A0\u4E0A.npmrc\u6587\u4EF6\u52A0\u5FEB\u5B89\u88C5\u901F\u5EA6",depth:2},{id:"\u5176\u5B83\u63D2\u4EF6\u5927\u5BB6\u53EF\u4EE5\u81EA\u884C\u7814\u7A76",text:"\u5176\u5B83\u63D2\u4EF6\uFF0C\u5927\u5BB6\u53EF\u4EE5\u81EA\u884C\u7814\u7A76",depth:2},{id:"\u672C\u7AD9\u6E90\u7801",text:"\u672C\u7AD9\u6E90\u7801",depth:2}],title:"",frontmatter:{layout:"post",title:"rollup \u5165\u95E8",date:"2024-04-30T10:08:00.000Z",categories:["\u6784\u5EFA\u5DE5\u5177"],tags:["rollup"]}}}}]);